# Item 76 : 가능한 한 실패를 원자적으로 만들라.

> 💡 예외가 발생해도 정상적으로 사용할 수 있는 상태? -> **Brilliant!**
> 
> → 호출된 메서드가 실패하더라도 해당 객체는 메서드 호출 전 상태를 유지해야 한다.

<br>

### Failure-atomic(실패 원자적)
호출된 메서드가 실패하더라도 해당 객체는 메서드 호출 전 상태를 유지해야 한다.

<br>

### How to?
- **불변 객체로 설계한다.**
  태생적으로 실패 원자적이다!
- 가변 객체라면, **작업 수행에 앞서 매개변수의 유효성을 검사한다.**
  ```java
  public Object pop() {
    if (size == 0) {
      throw new EmptyStackException();
    Object result = elements[--size];
    elements[size] = null;
    return result;
  }
  ```
- 객체의 임시 복사본에서 작업을 수행한 다음, 성공하면 원래 객체와 교체
- 발생하는 실패를 가로채 작업 전 상태로 Roll back

<br>

### 항상 달성가능한가?
항상 달성가능하지 않다.

ex) 두 스레드가 동기화 없이 같은 객체를 동시에 수정한다면 그 객체의 일관성이 깨질 수 있다.

Exception을 잡아냈다고 하더라도, 그 객체는 여전히 쓸 수 있는 상태가 아닐 수 있다.

 
